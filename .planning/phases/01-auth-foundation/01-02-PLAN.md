---
phase: 01-auth-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - app/(auth)/login/page.tsx
  - app/(auth)/signup/page.tsx
  - app/(auth)/layout.tsx
autonomous: true

must_haves:
  truths:
    - "User can access /login page and see login form"
    - "User can access /signup page and see signup form with name, company, email, password fields"
    - "User can submit login form and receive success/error feedback via toast"
    - "User can submit signup form and receive email confirmation message"
    - "Login page has link to signup, signup page has link to login"
  artifacts:
    - path: "app/(auth)/login/page.tsx"
      provides: "Login page with Supabase auth"
      contains: "signInWithPassword"
    - path: "app/(auth)/signup/page.tsx"
      provides: "Signup page with Supabase auth"
      contains: "signUp"
    - path: "app/(auth)/layout.tsx"
      provides: "Auth layout wrapper"
      min_lines: 5
  key_links:
    - from: "app/(auth)/login/page.tsx"
      to: "lib/supabase/client.ts"
      via: "createClient import"
      pattern: "from.*lib/supabase/client"
    - from: "app/(auth)/signup/page.tsx"
      to: "lib/supabase/client.ts"
      via: "createClient import"
      pattern: "from.*lib/supabase/client"
    - from: "app/(auth)/login/page.tsx"
      to: "sonner"
      via: "toast notifications"
      pattern: "toast\\.(success|error)"
---

<objective>
Create login and signup pages with Supabase authentication integration.

Purpose: Allow users to create accounts and log in to access the dashboard.

Output:
- /login page with email/password form
- /signup page with name, company (optional), email, password form
- Toast notifications for success/error states
- Links between login and signup pages
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-auth-foundation/01-CONTEXT.md
@.planning/phases/01-auth-foundation/01-01-SUMMARY.md

**Auth flow decisions from CONTEXT:**
- Signup: Nome, Nome da Empresa (opcional), Email, Senha
- Signup success: toast "Verifique seu email para confirmar" + redirect to /login
- Login success: redirect to /dashboard
- Use Supabase Auth signUp/signInWithPassword

**Existing components in project:**
- Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter (shadcn)
- Button (shadcn)
- Input (shadcn)
- Label (shadcn)
- sonner toast (already configured)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create auth layout</name>
  <files>app/(auth)/layout.tsx</files>
  <action>
    Create a route group for auth pages with a simple layout:

    ```tsx
    export default function AuthLayout({
      children,
    }: {
      children: React.ReactNode
    }) {
      return (
        <div className="min-h-screen flex items-center justify-center bg-muted/50 px-4">
          {children}
        </div>
      )
    }
    ```

    Create the app/(auth) directory first. The parentheses in (auth) make it a route group that doesn't affect URL paths.
  </action>
  <verify>
    Directory app/(auth) exists with layout.tsx file.
  </verify>
  <done>
    - app/(auth)/layout.tsx exists
    - Layout provides centered container with muted background
  </done>
</task>

<task type="auto">
  <name>Task 2: Create login page</name>
  <files>app/(auth)/login/page.tsx</files>
  <action>
    Create login page as a client component with:

    **Imports:**
    - useState from react
    - useRouter from next/navigation
    - Link from next/link
    - createClient from @/lib/supabase/client
    - Button, Input, Label from @/components/ui
    - Card components from @/components/ui/card
    - toast from sonner

    **State:**
    - email, password (strings)
    - loading (boolean)

    **handleLogin function:**
    1. Prevent default, set loading true
    2. Call supabase.auth.signInWithPassword({ email, password })
    3. If error: toast.error(error.message), set loading false
    4. If success: toast.success("Login realizado com sucesso!"), router.push("/dashboard")

    **UI structure:**
    - Card with max-w-md
    - CardHeader: Logo (SG in rounded box), title "Entrar", description
    - CardContent: Email input, Password input (with "Esqueceu a senha?" link placeholder)
    - CardFooter: Submit button, link to /signup

    **Full component code:**
    ```tsx
    "use client"

    import { useState } from "react"
    import { useRouter } from "next/navigation"
    import Link from "next/link"
    import { createClient } from "@/lib/supabase/client"
    import { Button } from "@/components/ui/button"
    import { Input } from "@/components/ui/input"
    import { Label } from "@/components/ui/label"
    import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card"
    import { toast } from "sonner"

    export default function LoginPage() {
      const router = useRouter()
      const [email, setEmail] = useState("")
      const [password, setPassword] = useState("")
      const [loading, setLoading] = useState(false)

      const handleLogin = async (e: React.FormEvent) => {
        e.preventDefault()
        setLoading(true)

        const supabase = createClient()
        const { error } = await supabase.auth.signInWithPassword({
          email,
          password,
        })

        if (error) {
          toast.error(error.message)
          setLoading(false)
          return
        }

        toast.success("Login realizado com sucesso!")
        router.push("/dashboard")
      }

      return (
        <Card className="w-full max-w-md">
          <CardHeader className="text-center">
            <div className="mx-auto w-12 h-12 bg-primary rounded-lg flex items-center justify-center mb-4">
              <span className="text-primary-foreground font-bold text-lg">SG</span>
            </div>
            <CardTitle className="text-2xl">Entrar</CardTitle>
            <CardDescription>
              Acesse sua conta do Sincron Grupos
            </CardDescription>
          </CardHeader>
          <form onSubmit={handleLogin}>
            <CardContent className="space-y-4">
              <div className="space-y-2">
                <Label htmlFor="email">Email</Label>
                <Input
                  id="email"
                  type="email"
                  placeholder="seu@email.com"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  required
                />
              </div>
              <div className="space-y-2">
                <Label htmlFor="password">Senha</Label>
                <Input
                  id="password"
                  type="password"
                  placeholder="Sua senha"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  required
                />
              </div>
            </CardContent>
            <CardFooter className="flex flex-col gap-4">
              <Button type="submit" className="w-full" disabled={loading}>
                {loading ? "Entrando..." : "Entrar"}
              </Button>
              <p className="text-sm text-muted-foreground text-center">
                Nao tem uma conta?{" "}
                <Link href="/signup" className="text-primary hover:underline">
                  Criar conta
                </Link>
              </p>
            </CardFooter>
          </form>
        </Card>
      )
    }
    ```
  </action>
  <verify>
    Visit http://localhost:3000/login - form should render with all fields visible.
  </verify>
  <done>
    - /login page renders login form
    - Email and password inputs are functional
    - Submit button shows loading state
    - Link to /signup is present
    - Form submits to Supabase auth
  </done>
</task>

<task type="auto">
  <name>Task 3: Create signup page</name>
  <files>app/(auth)/signup/page.tsx</files>
  <action>
    Create signup page as a client component with:

    **Imports:**
    - Same as login + Building2 icon from lucide-react

    **State:**
    - name, orgName, email, password (strings)
    - loading (boolean)

    **handleSignup function:**
    1. Prevent default, set loading true
    2. Call supabase.auth.signUp with email, password, and options.data containing name and org_name
    3. If error: toast.error(error.message), set loading false
    4. If success: toast.success("Conta criada! Verifique seu email para confirmar."), router.push("/login")

    **UI structure:**
    - Same Card layout as login
    - CardHeader: Logo, title "Criar Conta", description
    - CardContent: Name input, Company input (with icon, optional, helper text), Email input, Password input (min 6 chars)
    - CardFooter: Submit button, link to /login

    **Full component code:**
    ```tsx
    "use client"

    import { useState } from "react"
    import { useRouter } from "next/navigation"
    import Link from "next/link"
    import { createClient } from "@/lib/supabase/client"
    import { Button } from "@/components/ui/button"
    import { Input } from "@/components/ui/input"
    import { Label } from "@/components/ui/label"
    import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card"
    import { toast } from "sonner"
    import { Building2 } from "lucide-react"

    export default function SignupPage() {
      const router = useRouter()
      const [name, setName] = useState("")
      const [orgName, setOrgName] = useState("")
      const [email, setEmail] = useState("")
      const [password, setPassword] = useState("")
      const [loading, setLoading] = useState(false)

      const handleSignup = async (e: React.FormEvent) => {
        e.preventDefault()
        setLoading(true)

        const supabase = createClient()
        const { error } = await supabase.auth.signUp({
          email,
          password,
          options: {
            data: {
              name,
              org_name: orgName || `Organizacao de ${name}`,
            },
          },
        })

        if (error) {
          toast.error(error.message)
          setLoading(false)
          return
        }

        toast.success("Conta criada! Verifique seu email para confirmar.")
        router.push("/login")
      }

      return (
        <Card className="w-full max-w-md">
          <CardHeader className="text-center">
            <div className="mx-auto w-12 h-12 bg-primary rounded-lg flex items-center justify-center mb-4">
              <span className="text-primary-foreground font-bold text-lg">SG</span>
            </div>
            <CardTitle className="text-2xl">Criar Conta</CardTitle>
            <CardDescription>
              Comece a gerenciar seus grupos WhatsApp
            </CardDescription>
          </CardHeader>
          <form onSubmit={handleSignup}>
            <CardContent className="space-y-4">
              <div className="space-y-2">
                <Label htmlFor="name">Seu Nome</Label>
                <Input
                  id="name"
                  type="text"
                  placeholder="Seu nome completo"
                  value={name}
                  onChange={(e) => setName(e.target.value)}
                  required
                />
              </div>
              <div className="space-y-2">
                <Label htmlFor="orgName">Nome da Empresa</Label>
                <div className="relative">
                  <Building2 className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                  <Input
                    id="orgName"
                    type="text"
                    placeholder="Nome da sua empresa ou organizacao"
                    className="pl-10"
                    value={orgName}
                    onChange={(e) => setOrgName(e.target.value)}
                  />
                </div>
                <p className="text-xs text-muted-foreground">
                  Este sera o nome da sua organizacao no sistema
                </p>
              </div>
              <div className="space-y-2">
                <Label htmlFor="email">Email</Label>
                <Input
                  id="email"
                  type="email"
                  placeholder="seu@email.com"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  required
                />
              </div>
              <div className="space-y-2">
                <Label htmlFor="password">Senha</Label>
                <Input
                  id="password"
                  type="password"
                  placeholder="Minimo 6 caracteres"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  minLength={6}
                  required
                />
              </div>
            </CardContent>
            <CardFooter className="flex flex-col gap-4">
              <Button type="submit" className="w-full" disabled={loading}>
                {loading ? "Criando conta..." : "Criar Conta"}
              </Button>
              <p className="text-sm text-muted-foreground text-center">
                Ja tem uma conta?{" "}
                <Link href="/login" className="text-primary hover:underline">
                  Entrar
                </Link>
              </p>
            </CardFooter>
          </form>
        </Card>
      )
    }
    ```
  </action>
  <verify>
    Visit http://localhost:3000/signup - form should render with all 4 fields visible.
    Check that clicking link navigates to /login.
  </verify>
  <done>
    - /signup page renders signup form
    - Name, Company (with icon), Email, Password inputs are functional
    - Company field shows helper text
    - Submit button shows loading state
    - Link to /login is present
    - Form submits to Supabase auth with user metadata
  </done>
</task>

</tasks>

<verification>
1. Run `npm run dev` and test both pages:
   - Visit /login - form renders with email, password, submit button, signup link
   - Visit /signup - form renders with name, company, email, password, submit button, login link
2. Test navigation: Click links between login and signup pages
3. Test form validation: Try submitting empty forms (browser validation should prevent)
4. Visual check: Both pages use same Card styling, centered on screen
5. Test with invalid credentials (if Supabase is configured):
   - Login with wrong password shows error toast
   - Signup with existing email shows error toast
</verification>

<success_criteria>
- /login page accessible and displays login form
- /signup page accessible and displays signup form
- Both pages use shadcn Card components with consistent styling
- Forms have proper validation (required fields, min password length)
- Submit buttons show loading state during form submission
- Navigation links between pages work
- Forms call Supabase auth methods (signInWithPassword, signUp)
- Toast notifications show for success/error states
</success_criteria>

<output>
After completion, create `.planning/phases/01-auth-foundation/01-02-SUMMARY.md`
</output>
